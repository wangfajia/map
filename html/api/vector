_jsload2&&_jsload2('vector', 't.extend(fc.prototype,{na:function(a,b){Wb.prototype.na.call(this,a,b);this.Ve={};this.Fm(a);this.gm();this.xm()},remove:function(){var a=this.B;Wb.prototype.remove.call(this);a&&(a.removeEventListener("zoomend",this.ti),a.removeEventListener("moveend",this.ai),a.removeEventListener("resize",this.gi),a.removeEventListener("hotspotclick",this.JC),a.ij(this.k.Xh))},Fm:function(a){this.B=a;this.Au=this.nb;this.Gc=this.B.G.devicePixelRatio;this.ek=62;a.ij(this.k.Xh);for(var b in this.ml)delete this.ml[b]}, gm:function(){var a=this,b=this.B;a.ti=function(b){a.xm(b)};a.ai=function(b){a.xm(b)};a.gi=function(b){a.xm(b)};a.JC=function(b){0<b.spots.length&&a.SI(b.spots[0].getUserData().uid)};b.addEventListener("zoomend",a.ti);b.addEventListener("moveend",a.ai);b.addEventListener("resize",a.gi);b.addEventListener("hotspotclick",a.JC)},SI:function(a){var b=this,c=(1E5*Math.random()).toFixed(0);!B._rd&&(B._rd={});B._rd["_cbk"+c]=function(a){b.MG(a);delete B._rd["_cbk"+c]};var d=b.NK;this.k.pf&&(d=b.OK);a=d+ a+"?scope=2&ak="+this.k.aj+"&callback=BMap._rd._cbk"+c;this.k.pf&&(a+="&geotable_id="+this.k.pf);Ra(a)},MG:function(a){var b=a.content;this.k.pf&&(b=a.contents[0]);if(a&&0==a.status&&b){var a={poiId:b.uid||"",databoxId:b.databox_id||"",title:this.k.pf?b.title:b.name,address:this.k.pf?b.address:b.addr,phoneNumber:b.tel||"",postcode:b.zip||"",provinceCode:1*b.province_id||-1,province:b.province||"",cityCode:1*b.city_id||-1,city:b.city||"",districtCode:1*b.district_id||-1,district:b.district||"",point:this.k.pf? new H(b.location[0],b.location[1]):new H(b.longitude,b.latitude),tags:b.tag&&b.tag.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,"").split(/\\s+/),typeId:1*b.cla||-1,extendedData:b.ext||{}},c=new M("onhotspotclick");c.customPoi=a;c.content=b;this.ks&&this.ks.dispatchEvent(c);this.dispatchEvent(c)}},xm:function(){var a=this.B,b=a.V(),c=a.yb.jl(this.Au,"yun",this.ek);if(a.Eb()){this.Yh||(this.Yh=i,0<c.length&&(this.Jb=a.ja().k.Jb));this.hi=Math.pow(2,18-b);this.Af=c.length;a=0;for(b=c.length;a<b;a++)this.Rm(c[a][0], c[a][1],c[a][2])}},Rm:function(a,b,c){var d=this,e=d.map,f=e.Ea(),g=new H(f.lng,f.lat),j=e.V(),e=ic[Math.abs(a+b)%ic.length]+"/data?grids="+a+"_"+b+"_"+j+"&q="+this.k.Or+"&tags="+this.k.Ko+"&filter="+this.k.filter+"&sortby="+this.k.gs+"&ak="+this.k.aj+"&age="+this.k.qq,e=this.k.pf?e+("&geotable_id="+this.k.pf):e+("&databox_id="+this.k.FB);c.bf=o;Ra(e,function(e){var e=0==e.status?e.content[0].data:[],f=d.map,m=f.Ea(),f=f.V();m.gb(g)&&f==j&&(d.tk(e,c,a,b,j),d.Af--,0==d.Af&&d.ks.dispatchEvent("oncustomlayerloaded"))})}, tk:function(a,b,c,d,e){var f=b.getContext("2d");1<this.Gc&&!b.Ri&&(f.scale(this.Gc,this.Gc),b.Ri=i);b.zu||(b.zu=i,f.translate(this.ek/2,this.ek/2));for(var e="hotSpotTile_"+c+"_"+d+"_"+e,g=0,j=a.length;g<j;g++)this.iL(f,a[g],c,d,e,b)},iL:function(a,b,c,d,e,f){var g=this,j=b[0],k=b[1],l=b[2],m=b[3],g=this,q=this.Jb,b=this.hi,c=c*b*q,d=(d+1)*b*q;/^POINT\\((.*)\\)$/.test(l);var l=RegExp.$1.split(","),u=l[0],v=l[1],y=(u-c)/b,z=(d-v)/b,G=new Image;G.onload=function(){var b=this.width,c=this.height;a.drawImage(this, y-b/2,z-c);g.ml[e]||(b={userData:{name:j,uid:k},offsets:[c,b/2,0,b/2]},b=new Qa(P.tb(new H(u,v)),b),g.B.mq(b,g.k.Xh));setTimeout(function(){g.ml[e]=i;f.bf=i},1E3);delete this.onload};this.iM(m,function(a){""==m&&(m="sid1");G.src=a&&a.content&&a.content[m]&&""!=a.content[m]?"data:image/png;base64,"+a.content[m]:C.ca+"madian.png"})},OR:function(){if(this.nb){for(var a=this.nb,b=0,c=a.childNodes.length;b<c;b++)a.childNodes[b].bf=o;this.B.ij(this.k.Xh);for(var d in this.ml)delete this.ml[d];this.xm()}}, iM:function(a,b){var c=this,d=this.k.FB,e=this.k.PO,f=this.k.aj;""==a&&(a="sid1");if(this.Ve[a]&&this.Ve[a].data)b(this.Ve[a].data);else{this.Ve[a]||(this.Ve[a]={},this.Ve[a].Mu=[]);this.Ve[a].Mu.push(b);var g="http://api.map.baidu.com/style/poi/rangestyle?method=getstyle";this.k.pf&&(d=this.k.pf);g+="&databox="+d+"&sid="+a+"&ak="+f;e&&(g+="&self_id="+e);this.Ve[a].VM||(setTimeout(function(){Ra(g,function(b){var d=c.Ve[a].Mu;c.Ve[a].data=b;for(var e=0;e<d.length;e++)d[e](b);c.Ve[a].Mu.length=0})}, 10),c.Ve[a].VM=i)}}});t.extend(gc.prototype,{na:function(a,b){Wb.prototype.na.call(this,a,b);this.Fm(a);this.gm();this.mp()},remove:function(){var a=this.B;Wb.prototype.remove.call(this);a.removeEventListener("zoomend",this.ti);a.removeEventListener("moveend",this.ai);a.removeEventListener("resize",this.gi)},Fm:function(a){this.B=a;this.Au=this.nb;this.Gc=this.B.G.devicePixelRatio;this.ek=0},gm:function(){var a=this,b=this.B;a.ti=function(b){a.mp(b)};a.ai=function(b){a.mp(b)};a.gi=function(b){a.mp(b)};b.addEventListener("zoomend", a.ti);b.addEventListener("moveend",a.ai);b.addEventListener("resize",a.gi)},mp:function(){var a=this.B,b=a.yb.jl(this.Au,"traffic",this.ek);this.Yh||(this.Yh=i,0<b.length&&(this.Jb=a.ja().k.Jb));for(var a=0,c=b.length;a<c;a++)this.Rm(b[a][0],b[a][1],b[a][2])},Rm:function(a,b,c){var d=this,e=d.map,f=e.Ea(),g=new H(f.lng,f.lat),j=e.V(),k="_t"+parseInt(a+""+b+""+j).toString(36),e=this.kP+"&x="+a+"&y="+b+"&z="+j+"&fn=BMap."+k+"&t="+(new Date).getTime();c.bf=o;B[k]=function(e){var f=d.map,q=f.Ea(),f=f.V(); q.gb(g)&&f==j&&e.content&&e.content.tf&&d.tk(e.content.tf,c,a,b);delete B[k]};Ra(e,o)},tk:function(a,b){var c=b.getContext("2d"),d=this.$g,e=this.cw,f=this.ew;1<this.Gc&&!b.Ri&&(c.scale(this.Gc,this.Gc),b.Ri=i);b.zu||(b.zu=i,c.translate(this.ek/2,this.ek/2));for(var g=0,j=a.length;g<j;g++){var k=a[g],l=k[1],m=this.ac[k[3]],k=this.ac[k[4]],q=l[0]/10,u=l[1]/10;c.beginPath();c.moveTo(q,u);for(var v=2,y=l.length;v<y;v+=2)q+=l[v]/10,u+=l[v+1]/10,c.lineTo(q,u);c.strokeStyle=d(m[1]);c.lineWidth=m[2];c.lineCap= e(m[3]);c.lineJoin=f(m[4]);c.stroke();c.strokeStyle=d(k[1]);c.lineWidth=k[2];c.lineCap=e(k[3]);c.lineJoin=f(k[4]);c.stroke()}b.bf=i},$g:function(a){a>>>=0;return"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},cw:function(a){return["butt","square","round"][a]},ew:function(a){return["miter","bevel","round"][a]}});t.extend(Ka.prototype,{ud:function(){this.na(this.B,this.C)},na:function(a,b){this.B=a;this.C=b;this.B&&this.C&&(this.Fm(),this.SH(),this.gm(),this.wm())},remove:function(){var a=this.B;this.C.removeChild(this.Zb);a.removeEventListener("zoomend",this.ti);a.removeEventListener("moving",this.FD);a.removeEventListener("moveend",this.ai);a.removeEventListener("resize",this.gi)},Fm:function(){var a=this.B,b=a.G.devicePixelRatio,c=a.ja().k.Jb,d=a.Cb(),a=d.width,d=d.height;this.$f={};this.Jb=c;this.Gc=b; this.Pw=a;this.Ow=d;this.av=a*b;this.$u=d*b},SH:function(){var a=this.B,b=this.C,c=document.createElement("canvas"),d=c.style;d.position="absolute";d.zIndex=5;d.left=-a.offsetX+"px";d.top=-a.offsetY+"px";d.width=this.Pw+"px";d.height=this.Ow+"px";c.setAttribute("width",this.av);c.setAttribute("height",this.$u);b.appendChild(c);this.Zb=c;this.Fg=c.getContext("2d");a=this.Gc;1<a&&!c.Ri&&(this.Fg.scale(a,a),c.Ri=i)},gm:function(){function a(){b.Zb.style.left=-c.offsetX+"px";b.Zb.style.top=-c.offsetY+ "px"}var b=this,c=b.B,d=b.Gc;b.ti=function(c){b.Zb.style.display=18>this.V()?"none":"block";a();b.wm(c)};b.FD=function(c){var d=(new Date).getTime();100>d-b.hD||(b.hD=d,a(),b.wm(c))};b.ai=function(c){a();b.wm(c)};b.gi=function(e){var f=c.Cb(),g=f.width,f=f.height,j=g*d,k=f*d;b.Zb.style.width=g+"px";b.Zb.style.height=f+"px";b.Zb.setAttribute("width",j);b.Zb.setAttribute("height",k);b.Pw=g;b.Ow=f;b.av=j;b.$u=k;a();b.wm(e)};c.addEventListener("zoomend",b.ti);c.addEventListener("moving",b.FD);c.addEventListener("moveend", b.ai);c.addEventListener("resize",b.gi)},wm:function(a){var b=this.B,c=b.V();if(!(18>c)){var d=b.yb.kC(),e=d[0],b=d[1],f=d[2],d=d[3],a=a?o:i,g;for(g in this.$f)for(var j=e;j<f;j++)for(var k=b;k<d;k++)g==j+"_"+k+"_"+c&&(this.$f[g].Fz=i);for(g in this.$f)this.$f[g].Fz?delete this.$f[g].Fz:(this.$f[g]=n,delete this.$f[g]);this.Fg.clearRect(0,0,this.av,this.$u);for(j=e;j<f;j++)for(k=b;k<d;k++)(g=this.$f[j+"_"+k+"_"+c])?this.tk(g,j,k,c,a):this.Rm(j,k,c,a)}},Rm:function(a,b,c,d){var e=this,f=e.B,g=e.fK, j=(a+b)%g.length,k="x="+a+"&y="+b+"&z="+c,l=f.P.replace(/^TANGRAM_/,"")+"building"+parseInt(a+""+b+""+c).toString(36),g=g[j]+"qt=hjpgvd&"+k+"&styles=pl&layers=bg&features=bd&f=mwebapp&v=001&udt=20130501&fn=BMap."+l,j=f.Ea(),m=new H(j.lng,j.lat),q=f.V();B[l]=function(g){if(g=g.content){var j=f.Ea(),k=f.V();if(!j.gb(m)||k!=q){delete B[l];return}if(g=window.DN(g))e.tk(g,a,b,c,d),e.$f[a+"_"+b+"_"+c]=g}delete B[l]};Ra(g)},tk:function(a,b,c,d,e){e&&this.k.dC?this.RG(a,b,c,d):this.dz(a,b,c,d,1)},RG:function(a, b,c,d){var e=this;a.VF=new ab({Tc:50,duration:200,oa:function(f){e.dz(a,b,c,d,f)},finish:function(){a.VF=n}})},dz:function(a,b,c,d,e){var f=this.B,g=this.Pw,j=this.Ow,d=f.ja().Ob(d),f=f.Tb,k=this.Jb,b=b*k-f.lng/d,c=(-1-c)*k+f.lat/d,d=this.Fg,f=a.length,k=0,l=window.ac;d.save();for(d.translate(b+g/2,c+j/2);k<f;k++){var m=a[k],q=l[m[3]];if(4==q[0]){var u=m[7];window.VectorDrawUtils.UB(d,m[1],6*(m[2]*q[3])*e,90*((b+(u[0]+u[2])/2)/(g/2)),90*((c+(u[1]+u[3])/2)/(j/2)),"rgba(212,205,197,1)","rgba(235,233,228,1)", "rgba(170,170,170,1)",1)}}d.restore()}}); ');
